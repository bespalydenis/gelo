{"ast":null,"code":"import { takeLatest, all, put, call } from 'redux-saga/effects';\nimport { REQUEST_USERS, receiveUsers, ADD_USER, addUser, SET_CURRENT_USER, LOGIN, login, loginSuccess } from '../actions';\nimport axios from 'axios';\nimport setAuthToken from \"../../utils/setAuthToken\";\nimport jwt from \"jsonwebtoken\"; // LOGIN + AUTH TOKEN\n\nfunction callLogin(data) {\n  let result = {};\n  axios.post('/api/users/login', {\n    email: data.email,\n    password: data.password\n  }).then(res => {\n    localStorage.setItem('jwtToken', res.data.token);\n    setAuthToken(res.data.token);\n    result = res.body;\n    console.log('>> Login ID', res);\n  }).catch(err => {\n    console.log('>>', err);\n  });\n  return result; // return axios.post({\n  //     method: 'post',\n  //     url: '/api/users/login'\n  // });\n}\n\nfunction* userLogin(action) {\n  try {\n    const responce = yield call(callLogin, action.data);\n    console.log('>> responce', responce);\n\n    if (responce) {\n      console.log('have resp', responce);\n      yield put(loginSuccess(responce.data));\n    } else {\n      console.log('nhr', responce);\n    }\n  } catch (e) {\n    console.log('>> Login Error', e);\n  }\n}\n\nfunction fetchUnits(data) {\n  let result = [];\n  axios.get('/api/users/units', data).then(data => {\n    console.log('>> Success', data);\n    result = data;\n  }).catch(e => {\n    console.log('>> Error', e);\n  });\n  return result;\n}\n\nfunction* getUsers(action) {\n  try {\n    const response = yield call(fetchUnits, action.data);\n    const units = response.data;\n    yield put(receiveUsers(units));\n  } catch (e) {\n    yield put(receiveUsers('Test was success! Error!'));\n  }\n}\n\nfunction* addNewUser(action) {\n  console.log('>> ANU');\n\n  try {\n    // const response = yield call(fetchUnits, action.data);\n    // const units = response.data;\n    // console.log('>> unitsGet', action, data);\n    // yield put(receiveUsers(units));\n    axios.post('/api/users/register', action.data).then(res => {\n      console.log('>> addUser', res);\n    }).catch(errors => {\n      if (errors.response) {\n        console.log('>> E2');\n      } else if (errors.request) {\n        console.log('E', errors.request);\n      } else {\n        console.log('Error', errors.message);\n      }\n    });\n  } catch (e) {\n    yield put(receiveUsers('Test was success! Error!'));\n  }\n}\n\nfunction* watcher() {\n  yield takeLatest(REQUEST_USERS, getUsers);\n  yield takeLatest(ADD_USER, addNewUser);\n  yield takeLatest(LOGIN, userLogin);\n}\n\nexport default function* saga() {\n  yield all([watcher()]);\n}","map":{"version":3,"sources":["/Applications/MAMP/htdocs/raps/gelo/frontend/src/store/saga/index.js"],"names":["takeLatest","all","put","call","REQUEST_USERS","receiveUsers","ADD_USER","addUser","SET_CURRENT_USER","LOGIN","login","loginSuccess","axios","setAuthToken","jwt","callLogin","data","result","post","email","password","then","res","localStorage","setItem","token","body","console","log","catch","err","userLogin","action","responce","e","fetchUnits","get","getUsers","response","units","addNewUser","errors","request","message","watcher","saga"],"mappings":"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","sourcesContent":["import { takeLatest, all, put, call } from 'redux-saga/effects';\nimport {REQUEST_USERS, receiveUsers, ADD_USER, addUser, SET_CURRENT_USER, LOGIN, login, loginSuccess} from '../actions';\nimport axios from 'axios'\nimport setAuthToken from \"../../utils/setAuthToken\";\nimport jwt from \"jsonwebtoken\";\n\n\n\n// LOGIN + AUTH TOKEN\nfunction callLogin(data) {\n    let result = {};\n    axios.post('/api/users/login', {email: data.email, password: data.password})\n        .then(res => {\n            localStorage.setItem('jwtToken', res.data.token);\n            setAuthToken(res.data.token);\n            result = res.body;\n            console.log('>> Login ID', res);\n        })\n        .catch(err => {\n            console.log('>>',err)\n        });\n    return result;\n\n    // return axios.post({\n    //     method: 'post',\n    //     url: '/api/users/login'\n    // });\n}\n\nfunction* userLogin(action) {\n    try {\n        const responce = yield call(callLogin, action.data);\n        console.log('>> responce', responce);\n        if(responce) {\n            console.log('have resp', responce);\n            yield put(loginSuccess(responce.data))\n        } else {\n            console.log('nhr', responce);\n        }\n    } catch(e) {\n        console.log('>> Login Error', e);\n    }\n}\n\nfunction fetchUnits(data) {\n    let result = [];\n\n    axios.get('/api/users/units', data).then(data => {\n        console.log('>> Success', data);\n        result = data;\n    }).catch(e => {\n       console.log('>> Error', e);\n    });\n\n    return result;\n}\n\nfunction* getUsers(action) {\n    try {\n        const response = yield call(fetchUnits, action.data);\n        const units = response.data;\n        yield put(receiveUsers(units));\n    } catch(e) {\n        yield put(receiveUsers('Test was success! Error!'));\n    }\n}\n\nfunction* addNewUser(action) {\n    console.log('>> ANU');\n    try {\n        // const response = yield call(fetchUnits, action.data);\n        // const units = response.data;\n        // console.log('>> unitsGet', action, data);\n        // yield put(receiveUsers(units));\n\n        axios.post('/api/users/register', action.data)\n            .then(res => {\n                console.log('>> addUser', res);\n            })\n            .catch(errors => {\n                if (errors.response) {\n                   console.log('>> E2');\n                } else if (errors.request) {\n                    console.log('E', errors.request);\n                } else {\n                    console.log('Error', errors.message);\n                }\n            })\n    } catch(e) {\n        yield put(receiveUsers('Test was success! Error!'));\n    }\n}\n\n\nfunction* watcher() {\n    yield takeLatest(REQUEST_USERS, getUsers);\n    yield takeLatest(ADD_USER, addNewUser);\n    yield takeLatest(LOGIN, userLogin);\n}\n\nexport default function* saga() {\n    yield all([watcher()]);\n}"]},"metadata":{},"sourceType":"module"}